(this["webpackJsonpair-freshener"]=this["webpackJsonpair-freshener"]||[]).push([[0],{10:function(t,e,a){t.exports={container:"styles_container__3un5n",wrapper:"styles_wrapper__2GKub",show:"styles_show__eYaCF",section:"styles_section__k8e-n",inputArea:"styles_inputArea__2nZMU",goBack:"styles_goBack__3jVWD"}},15:function(t,e,a){t.exports={graphContainer:"styles_graphContainer__rvnP9"}},17:function(t,e,a){t.exports={loadingOverlay:"styles_loadingOverlay__25Hxt",body:"styles_body__32Flv",contentWrapper:"styles_contentWrapper__fzvAO"}},20:function(t,e,a){t.exports={bar:"style_bar__3UGFG",barTitle:"style_barTitle__2GbdM"}},31:function(t,e,a){t.exports={battery:"styles_battery__b2nck"}},38:function(t,e,a){},39:function(t,e,a){},5:function(t,e,a){t.exports={mainGrid:"styles_mainGrid__1mR3b",card:"styles_card__4jqsg",cardMainContent:"styles_cardMainContent__16FlH",cardBottomText:"styles_cardBottomText__2q2-n",clickable:"styles_clickable__14Tnt",totalGrid:"styles_totalGrid__dD4zH",totalRow:"styles_totalRow__1kBP_",totalTitle:"styles_totalTitle__1Du8w",totalValue:"styles_totalValue__3XFFk"}},65:function(t,e,a){"use strict";a.r(e);var n=a(2),r=a.n(n),c=a(30),i=a.n(c),s=(a(38),a(39),a(20)),o=a.n(s),l=a(13),u=a(11),d=a(8),j=a.n(d),v=a(31),b=a.n(v),f=6.5,p=9.6,h=[6.5,7,8.5,9.5],m=a(3),O=a(9),x=a(4),y=a.n(x),g=a(7),_=a(32),w=a.n(_).a.create({baseURL:"https://air-freshener-iot-default-rtdb.europe-west1.firebasedatabase.app/",withCredentials:!1}),k=function(){var t=Object(g.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.get("data/battery.json");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),N=function(){var t=Object(g.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.get("data/trigger.json");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),T=function(){return w.get("settings.json").then((function(t){return t.data}))},C=function(){var t=Object(g.a)(y.a.mark((function t(e){var a;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T();case 2:return a=t.sent,t.abrupt("return",w.put("settings.json",Object(m.a)(Object(m.a)({},a),e)));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),S=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=new Array(24).fill(0).map((function(t,e){return{hour:e,value:0}}));return t.forEach((function(t){var a=t.time,n=t.value,r=F(a);e[r]=Object(m.a)(Object(m.a)({},e[r]),{},{value:e[r].value+n})})),e},A=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"day",a=t.filter((function(t){var a=t.time;return j()(a).isSame(j()(),e)}));return a.reduce((function(t,e){return t+e.value}),0)},F=function(t){return+j()(t).format("H")},V={data:{plots:{voltage:{data:[]},activations:{data:[]}},currentState:{voltage:{value:0,lastPush:j()()},recentActivity:{day:0,week:0,month:0}},settings:{activeTime:0,sleepTime:0,sprayInterval:0}},startService:function(){},fetchData:function(){var t=Object(g.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),fetchSettings:function(){var t=Object(g.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),saveSettings:function(){var t=Object(g.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),isFetching:!0},B=r.a.createContext(V),G=a(0),D=function(){var t,e=Object(n.useContext)(B).data.currentState.voltage,a=e.value,r=e.lastPush,c=(t=a)<h[0]?[u.a,"#eb3f33"]:t<h[1]?[u.d,"#ffce5c"]:t<h[2]?[u.c,"#5fd393"]:t<h[3]?[u.e,"#5fd393"]:[u.b,"#5fd393"];return Object(G.jsxs)("div",{className:b.a.battery,children:[Object(G.jsx)(l.a,{icon:c[0],color:c[1]}),Object(G.jsx)("div",{children:a+"V"}),Object(G.jsx)("div",{style:{color:"#888"},children:function(){var t=j()(),e="seconds",a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"s";return t.diff(j()(r),e)},n=a("s");return n>=60&&(e="minutes",(n=a("m"))>=60&&(e="hours",(n=a("h"))>=24&&(e="days",n=a("d")))),[n,e]}().join(" ")+" ago"})]})},z=function(){return Object(G.jsxs)("div",{className:o.a.bar,children:[Object(G.jsx)("div",{className:o.a.barTitle,children:"AirPshicker"}),Object(G.jsx)(D,{})]})},M=a(17),P=a.n(M),R=a(33),E=a(5),H=a.n(E),I=a(14),L=a.n(I),W=a(15),U=a.n(W),q=function(t){var e=t.data,a=void 0===e?[]:e,n={colors:["#5fd393"],chart:{type:"area",stacked:!1,height:350,zoom:{type:"x",enabled:!0,autoScaleYaxis:!0},toolbar:{autoSelected:"zoom",tools:{download:!1,selection:!0,zoom:!0,zoomin:!1,zoomout:!1,pan:!0,reset:1,customIcons:[]}}},dataLabels:{enabled:!1},markers:{size:0},title:{text:"Battery Voltage",align:"left"},fill:{colors:["#5fd393"]},yaxis:{max:p,min:f,type:"numeric",title:{text:"Volts"},labels:{formatter:function(t){return t.toFixed(1)}}},xaxis:{type:"numeric",categories:a.map((function(t){return t.time})),labels:{formatter:function(t){return j()(t).format("DD/MM HH:mm")}}},tooltip:{shared:!1}},r=[{name:"Battery",data:a.map((function(t,e){var a=t.value;t.time;return a}))}];return Object(G.jsx)("div",{className:U.a.graphContainer,children:Object(G.jsx)(L.a,{options:n,series:r,type:"area",height:350,style:{width:"100%"}})})},J=function(t){var e=t.data,a=void 0===e?[]:e,n=[{data:a.map((function(t){return t.value})),name:"Activations"}],r={chart:{width:380,type:"radar"},title:{text:"Daily usage",align:"left"},plotOptions:{radar:{polygons:{strokeColor:"transparent",fill:{colors:["#fff"]}}}},labels:a.map((function(t){return t.hour})),fill:{opacity:.4},stroke:{show:!1,width:2,colors:[],dashArray:0},markers:{size:3},yaxis:{show:!1,labels:{formatter:function(t){return t+" times"}}},xaxis:{show:!0,categories:a.map((function(t){return t.hour+":00"})),labels:{show:!0}},legend:{show:!1}};return Object(G.jsx)("div",{className:U.a.graphContainer,children:Object(G.jsx)(L.a,{type:"radar",options:r,series:n,height:350,style:{width:"100%"}})})},Y=a(16),K=a.n(Y),X=a(10),Z=a.n(X),Q=function(t){var e=t.isVisible,a=t.onClose,r=void 0===a?function(){}:a,c=Object(n.useContext)(B),i=c.data.settings,s=c.fetchSettings,o=c.saveSettings,l=Object(n.useState)(i),u=Object(O.a)(l,2),d=u[0],j=u[1],v=function(){var t=Object(g.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o(d);case 2:r();case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(n.useEffect)((function(){s(),j(i)}),[e]),Object(G.jsxs)("div",{className:K()(Z.a.wrapper,e&&Z.a.show),children:[Object(G.jsx)("h1",{children:"Settings"}),Object(G.jsxs)("div",{className:Z.a.section,children:[Object(G.jsx)("span",{children:"Waiting time before sleep"}),Object(G.jsxs)("div",{className:Z.a.inputArea,children:[Object(G.jsx)("input",{value:d.activeTime,onChange:function(t){return j((function(e){return Object(m.a)(Object(m.a)({},e),{},{activeTime:t.target.value})}))},type:"number"}),"seconds"]})]}),Object(G.jsxs)("div",{className:Z.a.section,children:[Object(G.jsx)("span",{children:"Sleep time"}),Object(G.jsxs)("div",{className:Z.a.inputArea,children:[Object(G.jsx)("input",{value:d.sleepTime,onChange:function(t){return j((function(e){return Object(m.a)(Object(m.a)({},e),{},{sleepTime:t.target.value})}))},type:"number"}),"seconds"]})]}),Object(G.jsxs)("div",{className:Z.a.section,children:[Object(G.jsx)("span",{children:"Spray interval"}),Object(G.jsxs)("div",{className:Z.a.inputArea,children:[Object(G.jsx)("input",{type:"number",disabled:!0}),"minutes"]})]}),Object(G.jsx)("button",{onClick:v,children:"Apply changes"}),Object(G.jsx)("div",{onClick:r,className:Z.a.goBack,children:"< Back to home screen"})]})},$=function(t){var e=t.gridArea,a=void 0===e?"":e,n=t.mainComponent,r=void 0===n?"":n,c=t.bottomText,i=void 0===c?"":c,s=t.onCLick;return Object(G.jsxs)("div",{className:K()(H.a.card,s&&H.a.clickable),onClick:function(){s&&s()},style:{gridArea:a},children:[Object(G.jsx)("div",{className:H.a.cardMainContent,children:r}),Object(G.jsx)("div",{className:H.a.cardBottomText,children:i})]})},tt=function(t){var e=t.gridArea,a=void 0===e?"":e,n=Object(R.a)(t,["gridArea"]);return Object(G.jsx)("div",{className:H.a.card,style:{gridArea:a},children:n.children})},et=function(){var t,e,a,r,c,i,s,o,d,j,v,b,f,p,m=Object(n.useState)(!1),x=Object(O.a)(m,2),y=x[0],g=x[1],_=Object(n.useContext)(B),w=_.data,k=_.startService;Object(n.useEffect)((function(){k()}),[]);var N,T=Object(G.jsxs)("div",{className:H.a.totalGrid,children:[Object(G.jsxs)("div",{className:H.a.totalRow,children:[Object(G.jsx)("div",{className:H.a.totalTitle,children:"Today"}),Object(G.jsx)("div",{className:H.a.totalValue,children:null===(t=w.currentState)||void 0===t||null===(e=t.recentActivity)||void 0===e?void 0:e.day})]}),Object(G.jsxs)("div",{className:H.a.totalRow,children:[Object(G.jsx)("div",{className:H.a.totalTitle,children:"Week"}),Object(G.jsx)("div",{className:H.a.totalValue,children:null===(a=w.currentState)||void 0===a||null===(r=a.recentActivity)||void 0===r?void 0:r.week})]}),Object(G.jsxs)("div",{className:H.a.totalRow,children:[Object(G.jsx)("div",{className:H.a.totalTitle,children:"Month"}),Object(G.jsx)("div",{className:H.a.totalValue,children:null===(c=w.currentState)||void 0===c||null===(i=c.recentActivity)||void 0===i?void 0:i.month})]})]});return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)(Q,{isVisible:y,onClose:function(){return g(!1)}}),Object(G.jsxs)("div",{className:H.a.mainGrid,children:[Object(G.jsx)($,{mainComponent:Object(G.jsxs)("div",{className:H.a.totalRow,children:[Object(G.jsx)("div",{className:H.a.totalTitle,children:"Volts"}),Object(G.jsx)("div",{className:H.a.totalValue,children:(null===(s=w.currentState)||void 0===s||null===(o=s.voltage)||void 0===o?void 0:o.value)||"0.0"})]}),bottomText:(N=null===(d=w.currentState)||void 0===d||null===(j=d.voltage)||void 0===j?void 0:j.value,N<h[0]?"Too low. Needs charging":N<h[1]?"Running low":N<h[2]?"Enough to work":N<h[3]?"Good":"Fully charged"),gridArea:"volt"}),Object(G.jsx)($,{gridArea:"today",mainComponent:T,bottomText:"Activations"}),Object(G.jsx)($,{gridArea:"sets",mainComponent:Object(G.jsx)(l.a,{icon:u.f}),bottomText:"Settings",onCLick:function(){return g((function(t){return!t}))}}),Object(G.jsx)(tt,{gridArea:"graph1",children:Object(G.jsx)(q,{data:null===(v=w.plots)||void 0===v||null===(b=v.voltage)||void 0===b?void 0:b.data})}),Object(G.jsx)(tt,{gridArea:"graph2",children:Object(G.jsx)(J,{data:null===(f=w.plots)||void 0===f||null===(p=f.activations)||void 0===p?void 0:p.data})})]})]})};var at=function(){var t=function(){var t=Object(n.useState)(V),e=Object(O.a)(t,2),a=e[0],r=e[1];Object(n.useEffect)((function(){console.log(a)}),[a]);var c=function(){var t=Object(g.a)(y.a.mark((function t(){var e,a,n,c,i,s,o,l,u,d,j,v,b;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k();case 2:return e=t.sent,a=e.data,t.next=6,N();case 6:n=t.sent,c=n.data,i=Object.entries(a||{}).filter((function(t){return"last_id"!==Object(O.a)(t,1)[0]})).map((function(t){var e=Object(O.a)(t,2),a=(e[0],e[1]);return Object(m.a)(Object(m.a)({},a),{},{value:(a.value/1e3).toFixed(1),time:null===a||void 0===a?void 0:a.timestamp})})),s=i.slice(-1)[0],o=s.value,l=s.time,u=Object.entries(c||{}).filter((function(t){return"last_id"!==Object(O.a)(t,1)[0]})).map((function(t){var e=Object(O.a)(t,2),a=(e[0],e[1]);return Object(m.a)(Object(m.a)({},a),{},{time:null===a||void 0===a?void 0:a.timestamp})})),d=S(u),j=A(u,"day"),v=A(u,"week"),b=A(u,"month"),r((function(t){return Object(m.a)(Object(m.a)({},t),{},{isFetching:!1,data:Object(m.a)(Object(m.a)({},t.data),{},{plots:{voltage:{data:i},activations:{data:d}},currentState:{voltage:{value:o,lastPush:l},recentActivity:{day:j,week:v,month:b}}})})}));case 16:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),i=function(){var t=Object(g.a)(y.a.mark((function t(){var e,a,n;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T();case 2:e=t.sent,a=e.activeTime,n=e.sleepTime,r((function(t){return Object(m.a)(Object(m.a)({},t),{},{data:Object(m.a)(Object(m.a)({},t.data),{},{settings:{activeTime:a,sleepTime:n,sprayInterval:0}})})}));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),s=function(){var t=Object(g.a)(y.a.mark((function t(e){var a,n,r,c;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.activeTime,n=void 0===a?0:a,r=e.sleepTime,c=void 0===r?0:r,t.next=3,C({activeTime:Number(n),sleepTime:Number(c)});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(m.a)(Object(m.a)({},a),{},{startService:function(){setInterval((function(){c()}),5e3)},fetchData:c,fetchSettings:i,saveSettings:s})}();return Object(n.useEffect)((function(){t.fetchData()}),[]),Object(G.jsxs)(B.Provider,{value:t,children:[Object(G.jsx)("div",{className:P.a.loadingOverlay,style:{opacity:Number(t.isFetching)}}),Object(G.jsx)("div",{className:P.a.contentWrapper,children:Object(G.jsxs)("div",{className:P.a.body,children:[Object(G.jsx)(z,{}),Object(G.jsx)(et,{})]})})]})},nt=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,66)).then((function(e){var a=e.getCLS,n=e.getFID,r=e.getFCP,c=e.getLCP,i=e.getTTFB;a(t),n(t),r(t),c(t),i(t)}))};i.a.render(Object(G.jsx)(r.a.StrictMode,{children:Object(G.jsx)(at,{})}),document.getElementById("root")),nt()}},[[65,1,2]]]);
//# sourceMappingURL=main.465717a4.chunk.js.map