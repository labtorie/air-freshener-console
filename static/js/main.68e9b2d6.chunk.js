(this["webpackJsonpair-freshener"]=this["webpackJsonpair-freshener"]||[]).push([[0],{10:function(t,e,a){t.exports={container:"styles_container__3un5n",wrapper:"styles_wrapper__2GKub",show:"styles_show__eYaCF",section:"styles_section__k8e-n",inputArea:"styles_inputArea__2nZMU",goBack:"styles_goBack__3jVWD"}},15:function(t,e,a){t.exports={graphContainer:"styles_graphContainer__rvnP9"}},17:function(t,e,a){t.exports={loadingOverlay:"styles_loadingOverlay__25Hxt",body:"styles_body__32Flv",contentWrapper:"styles_contentWrapper__fzvAO"}},20:function(t,e,a){t.exports={bar:"style_bar__3UGFG",barTitle:"style_barTitle__2GbdM"}},31:function(t,e,a){t.exports={battery:"styles_battery__b2nck"}},38:function(t,e,a){},39:function(t,e,a){},5:function(t,e,a){t.exports={mainGrid:"styles_mainGrid__1mR3b",card:"styles_card__4jqsg",cardMainContent:"styles_cardMainContent__16FlH",cardBottomText:"styles_cardBottomText__2q2-n",clickable:"styles_clickable__14Tnt",totalGrid:"styles_totalGrid__dD4zH",totalRow:"styles_totalRow__1kBP_",totalTitle:"styles_totalTitle__1Du8w",totalValue:"styles_totalValue__3XFFk"}},65:function(t,e,a){"use strict";a.r(e);var n=a(2),r=a.n(n),s=a(30),i=a.n(s),c=(a(38),a(39),a(20)),o=a.n(c),l=a(13),u=a(11),d=a(8),f=a.n(d),j=a(31),v=a.n(j),b=6.5,p=9.6,h=[6.5,7,8.5,9.5],m=a(3),O=a(9),x=a(4),y=a.n(x),g=a(7),_=a(32),w=a.n(_).a.create({baseURL:"https://air-freshener-iot-default-rtdb.europe-west1.firebasedatabase.app/",withCredentials:!1}),k=function(){var t=Object(g.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.get("data/battery.json");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),N=function(){var t=Object(g.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.get("data/trigger.json");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),T=function(){return w.get("settings.json").then((function(t){return t.data}))},C=function(){var t=Object(g.a)(y.a.mark((function t(e){var a;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T();case 2:return a=t.sent,t.abrupt("return",w.put("settings.json",Object(m.a)(Object(m.a)({},a),e)));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),S=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=new Array(24).fill(0).map((function(t,e){return{hour:e,value:0}}));return t.forEach((function(t){var a=t.time,n=t.value,r=F(a);e[r]=Object(m.a)(Object(m.a)({},e[r]),{},{value:e[r].value+n})})),e},A=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"day",a=t.filter((function(t){var a=t.time;return f()(a).isSame(f()(),e)}));return a.reduce((function(t,e){return t+e.value}),0)},F=function(t){return+f()(t).format("H")},M={data:{plots:{voltage:{data:[]},activations:{data:[]}},currentState:{voltage:{value:0,lastPush:f()()},recentActivity:{day:0,week:0,month:0}},settings:{activeTime:0,sleepTime:0,sprayInterval:0}},startService:function(){},fetchData:function(){var t=Object(g.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),fetchSettings:function(){var t=Object(g.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),saveSettings:function(){var t=Object(g.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),isFetching:!0},W=r.a.createContext(M),V=a(0),B=function(){var t,e=Object(n.useContext)(W).data.currentState.voltage,a=e.value,r=e.lastPush,s=(t=a)<h[0]?[u.a,"#eb3f33"]:t<h[1]?[u.d,"#ffce5c"]:t<h[2]?[u.c,"#5fd393"]:t<h[3]?[u.e,"#5fd393"]:[u.b,"#5fd393"];return Object(V.jsxs)("div",{className:v.a.battery,children:[Object(V.jsx)(l.a,{icon:s[0],color:s[1]}),Object(V.jsx)("div",{children:a+"V"}),Object(V.jsx)("div",{style:{color:"#888"},children:function(){var t=f()(),e="seconds",a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"s";return t.diff(f()(r),e)},n=a("s");return n>=60&&(e="minutes",(n=a("m"))>=60&&(e="hours",(n=a("h"))>=24&&(e="days",n=a("d")))),[n,e]}().join(" ")+" ago"})]})},G=function(){return Object(V.jsxs)("div",{className:o.a.bar,children:[Object(V.jsx)("div",{className:o.a.barTitle,children:"AirPshicker"}),Object(V.jsx)(B,{})]})},D=a(17),z=a.n(D),P=a(33),R=a(5),E=a.n(R),H=a(14),I=a.n(H),L=a(15),U=a.n(L),q=function(t){var e=t.data,a=void 0===e?[]:e,n={colors:["#5fd393"],chart:{type:"area",stacked:!1,height:350,zoom:{type:"x",enabled:!0,autoScaleYaxis:!0},toolbar:{autoSelected:"zoom",tools:{download:!1,selection:!0,zoom:!0,zoomin:!1,zoomout:!1,pan:!0,reset:1,customIcons:[]}}},dataLabels:{enabled:!1},markers:{size:0},title:{text:"Battery Voltage",align:"left",style:{fontFamily:"Montserrat, sans-serif",fontWeight:700}},fill:{colors:["#5fd393"]},yaxis:{max:p,min:b,type:"numeric",title:{text:"Volts",style:{fontFamily:"Montserrat, sans-serif",fontWeight:500}},labels:{formatter:function(t){return t.toFixed(1)},style:{fontFamily:"Montserrat, sans-serif",fontWeight:500}}},xaxis:{type:"numeric",categories:a.map((function(t){return t.time})),labels:{formatter:function(t){return f()(t).format("DD.MM HH:mm")},style:{fontFamily:"Montserrat, sans-serif",fontWeight:500}}},tooltip:{shared:!1,style:{fontFamily:"Montserrat, sans-serif",fontWeight:500}}},r=[{name:"Battery",data:a.map((function(t,e){var a=t.value;t.time;return a}))}];return Object(V.jsx)("div",{className:U.a.graphContainer,children:Object(V.jsx)(I.a,{options:n,series:r,type:"area",height:350,style:{width:"100%"}})})},J=function(t){var e=t.data,a=void 0===e?[]:e,n=[{data:a.map((function(t){return t.value})),name:"Activations"}],r={chart:{width:380,type:"radar",toolbar:{tools:{download:!1}}},title:{text:"Daily usage",align:"left",style:{fontFamily:"Montserrat, sans-serif",fontWeight:700}},plotOptions:{radar:{polygons:{strokeColor:"transparent",fill:{colors:["#fff"]}}}},labels:a.map((function(t){return t.hour})),fill:{opacity:.4},stroke:{show:!1,width:2,colors:[],dashArray:0},markers:{size:3},yaxis:{show:!1,labels:{formatter:function(t){return t+" times"}}},xaxis:{show:!0,categories:a.map((function(t){return t.hour+":00"})),labels:{show:!0,style:{fontFamily:"Montserrat, sans-serif",fontWeight:500}}},legend:{show:!1},tooltip:{style:{fontFamily:"Montserrat, sans-serif",fontWeight:500}}};return Object(V.jsx)("div",{className:U.a.graphContainer,children:Object(V.jsx)(I.a,{type:"radar",options:r,series:n,height:350,style:{width:"100%"}})})},Y=a(16),K=a.n(Y),X=a(10),Z=a.n(X),Q=function(t){var e=t.isVisible,a=t.onClose,r=void 0===a?function(){}:a,s=Object(n.useContext)(W),i=s.data.settings,c=s.fetchSettings,o=s.saveSettings,l=Object(n.useState)(i),u=Object(O.a)(l,2),d=u[0],f=u[1],j=function(){var t=Object(g.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o(d);case 2:r();case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(n.useEffect)((function(){c(),f(i)}),[e]),Object(V.jsxs)("div",{className:K()(Z.a.wrapper,e&&Z.a.show),children:[Object(V.jsx)("h1",{children:"Settings"}),Object(V.jsxs)("div",{className:Z.a.section,children:[Object(V.jsx)("span",{children:"Waiting time before sleep"}),Object(V.jsxs)("div",{className:Z.a.inputArea,children:[Object(V.jsx)("input",{value:d.activeTime,onChange:function(t){return f((function(e){return Object(m.a)(Object(m.a)({},e),{},{activeTime:t.target.value})}))},type:"number"}),"seconds"]})]}),Object(V.jsxs)("div",{className:Z.a.section,children:[Object(V.jsx)("span",{children:"Sleep time"}),Object(V.jsxs)("div",{className:Z.a.inputArea,children:[Object(V.jsx)("input",{value:d.sleepTime,onChange:function(t){return f((function(e){return Object(m.a)(Object(m.a)({},e),{},{sleepTime:t.target.value})}))},type:"number"}),"seconds"]})]}),Object(V.jsxs)("div",{className:Z.a.section,children:[Object(V.jsx)("span",{children:"Spray interval"}),Object(V.jsxs)("div",{className:Z.a.inputArea,children:[Object(V.jsx)("input",{type:"number",disabled:!0}),"minutes"]})]}),Object(V.jsx)("button",{onClick:j,children:"Apply changes"}),Object(V.jsx)("div",{onClick:r,className:Z.a.goBack,children:"< Back to home screen"})]})},$=function(t){var e=t.gridArea,a=void 0===e?"":e,n=t.mainComponent,r=void 0===n?"":n,s=t.bottomText,i=void 0===s?"":s,c=t.onCLick;return Object(V.jsxs)("div",{className:K()(E.a.card,c&&E.a.clickable),onClick:function(){c&&c()},style:{gridArea:a},children:[Object(V.jsx)("div",{className:E.a.cardMainContent,children:r}),Object(V.jsx)("div",{className:E.a.cardBottomText,children:i})]})},tt=function(t){var e=t.gridArea,a=void 0===e?"":e,n=Object(P.a)(t,["gridArea"]);return Object(V.jsx)("div",{className:E.a.card,style:{gridArea:a},children:n.children})},et=function(){var t,e,a,r,s,i,c,o,d,f,j,v,b,p,m=Object(n.useState)(!1),x=Object(O.a)(m,2),y=x[0],g=x[1],_=Object(n.useContext)(W),w=_.data,k=_.startService;Object(n.useEffect)((function(){k()}),[]);var N,T=Object(V.jsxs)("div",{className:E.a.totalGrid,children:[Object(V.jsxs)("div",{className:E.a.totalRow,children:[Object(V.jsx)("div",{className:E.a.totalTitle,children:"Today"}),Object(V.jsx)("div",{className:E.a.totalValue,children:null===(t=w.currentState)||void 0===t||null===(e=t.recentActivity)||void 0===e?void 0:e.day})]}),Object(V.jsxs)("div",{className:E.a.totalRow,children:[Object(V.jsx)("div",{className:E.a.totalTitle,children:"Week"}),Object(V.jsx)("div",{className:E.a.totalValue,children:null===(a=w.currentState)||void 0===a||null===(r=a.recentActivity)||void 0===r?void 0:r.week})]}),Object(V.jsxs)("div",{className:E.a.totalRow,children:[Object(V.jsx)("div",{className:E.a.totalTitle,children:"Month"}),Object(V.jsx)("div",{className:E.a.totalValue,children:null===(s=w.currentState)||void 0===s||null===(i=s.recentActivity)||void 0===i?void 0:i.month})]})]});return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(Q,{isVisible:y,onClose:function(){return g(!1)}}),Object(V.jsxs)("div",{className:E.a.mainGrid,children:[Object(V.jsx)($,{mainComponent:Object(V.jsxs)("div",{className:E.a.totalRow,children:[Object(V.jsx)("div",{className:E.a.totalTitle,children:"Volts"}),Object(V.jsx)("div",{className:E.a.totalValue,children:(null===(c=w.currentState)||void 0===c||null===(o=c.voltage)||void 0===o?void 0:o.value)||"0.0"})]}),bottomText:(N=null===(d=w.currentState)||void 0===d||null===(f=d.voltage)||void 0===f?void 0:f.value,N<h[0]?"Too low. Needs charging":N<h[1]?"Running low":N<h[2]?"Enough to work":N<h[3]?"Good":"Fully charged"),gridArea:"volt"}),Object(V.jsx)($,{gridArea:"today",mainComponent:T,bottomText:"Activations"}),Object(V.jsx)($,{gridArea:"sets",mainComponent:Object(V.jsx)(l.a,{icon:u.f}),bottomText:"Settings",onCLick:function(){return g((function(t){return!t}))}}),Object(V.jsx)(tt,{gridArea:"graph1",children:Object(V.jsx)(q,{data:null===(j=w.plots)||void 0===j||null===(v=j.voltage)||void 0===v?void 0:v.data})}),Object(V.jsx)(tt,{gridArea:"graph2",children:Object(V.jsx)(J,{data:null===(b=w.plots)||void 0===b||null===(p=b.activations)||void 0===p?void 0:p.data})})]})]})};var at=function(){var t=function(){var t=Object(n.useState)(M),e=Object(O.a)(t,2),a=e[0],r=e[1];Object(n.useEffect)((function(){console.log(a)}),[a]);var s=function(){var t=Object(g.a)(y.a.mark((function t(){var e,a,n,s,i,c,o,l,u,d,f,j,v;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k();case 2:return e=t.sent,a=e.data,t.next=6,N();case 6:n=t.sent,s=n.data,i=Object.entries(a||{}).filter((function(t){return"last_id"!==Object(O.a)(t,1)[0]})).map((function(t){var e=Object(O.a)(t,2),a=(e[0],e[1]);return Object(m.a)(Object(m.a)({},a),{},{value:(a.value/1e3).toFixed(1),time:null===a||void 0===a?void 0:a.timestamp})})),c=i.slice(-1)[0],o=c.value,l=c.time,u=Object.entries(s||{}).filter((function(t){return"last_id"!==Object(O.a)(t,1)[0]})).map((function(t){var e=Object(O.a)(t,2),a=(e[0],e[1]);return Object(m.a)(Object(m.a)({},a),{},{time:null===a||void 0===a?void 0:a.timestamp})})),d=S(u),f=A(u,"day"),j=A(u,"week"),v=A(u,"month"),r((function(t){return Object(m.a)(Object(m.a)({},t),{},{isFetching:!1,data:Object(m.a)(Object(m.a)({},t.data),{},{plots:{voltage:{data:i},activations:{data:d}},currentState:{voltage:{value:o,lastPush:l},recentActivity:{day:f,week:j,month:v}}})})}));case 16:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),i=function(){var t=Object(g.a)(y.a.mark((function t(){var e,a,n;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T();case 2:e=t.sent,a=e.activeTime,n=e.sleepTime,r((function(t){return Object(m.a)(Object(m.a)({},t),{},{data:Object(m.a)(Object(m.a)({},t.data),{},{settings:{activeTime:a,sleepTime:n,sprayInterval:0}})})}));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),c=function(){var t=Object(g.a)(y.a.mark((function t(e){var a,n,r,s;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.activeTime,n=void 0===a?0:a,r=e.sleepTime,s=void 0===r?0:r,t.next=3,C({activeTime:Number(n),sleepTime:Number(s)});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(m.a)(Object(m.a)({},a),{},{startService:function(){setInterval((function(){s()}),5e3)},fetchData:s,fetchSettings:i,saveSettings:c})}();return Object(n.useEffect)((function(){t.fetchData()}),[]),Object(V.jsxs)(W.Provider,{value:t,children:[Object(V.jsx)("div",{className:z.a.loadingOverlay,style:{opacity:Number(t.isFetching)}}),Object(V.jsx)("div",{className:z.a.contentWrapper,children:Object(V.jsxs)("div",{className:z.a.body,children:[Object(V.jsx)(G,{}),Object(V.jsx)(et,{})]})})]})},nt=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,66)).then((function(e){var a=e.getCLS,n=e.getFID,r=e.getFCP,s=e.getLCP,i=e.getTTFB;a(t),n(t),r(t),s(t),i(t)}))};i.a.render(Object(V.jsx)(r.a.StrictMode,{children:Object(V.jsx)(at,{})}),document.getElementById("root")),nt()}},[[65,1,2]]]);
//# sourceMappingURL=main.68e9b2d6.chunk.js.map