(this["webpackJsonpair-freshener"]=this["webpackJsonpair-freshener"]||[]).push([[0],{11:function(e,t,a){e.exports={mainGrid:"styles_mainGrid__1mR3b",card:"styles_card__4jqsg",cardMainContent:"styles_cardMainContent__16FlH",cardBottomText:"styles_cardBottomText__2q2-n",clickable:"styles_clickable__14Tnt",totalGrid:"styles_totalGrid__dD4zH",totalRow:"styles_totalRow__1kBP_",totalTitle:"styles_totalTitle__1Du8w",totalValue:"styles_totalValue__3XFFk"}},13:function(e,t,a){e.exports={container:"styles_container__3un5n",wrapper:"styles_wrapper__2GKub",show:"styles_show__eYaCF",section:"styles_section__k8e-n",inputArea:"styles_inputArea__2nZMU",settingsHeader:"styles_settingsHeader__2DDi6",signOut:"styles_signOut__34wIp",goBack:"styles_goBack__3jVWD"}},130:function(e,t,a){"use strict";a.r(t);var n=a(4),r=a.n(n),s=a(50),i=a.n(s),c=(a(59),a(6)),o=a(38),l=a.n(o),u=a(22),d=a(18),j=a(16),f=a.n(j),b=a(51),v=a.n(b),p=6.5,h=9.6,m=[6.5,7,8.5,9.5],O=a(17),x=a(7),g=a.n(x),y=a(14),_=a(52),w=a.n(_),k=a(19),N=w.a.create({baseURL:"https://air-freshener-iot-default-rtdb.europe-west1.firebasedatabase.app/",withCredentials:!1}),T=function(){var e=Object(y.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.get("data/battery.json");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(y.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.get("data/trigger.json");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(){return N.get("settings.json").then((function(e){return e.data}))},A=function(){var e=Object(y.a)(g.a.mark((function e(t){var a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.auth().currentUser.getIdToken();case 2:return a=e.sent,e.next=5,C();case 5:return n=e.sent,e.abrupt("return",N.put("settings.json?auth="+a,Object(c.a)(Object(c.a)({},n),t)));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(y.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.auth().signInWithEmailAndPassword("labtorie@gmail.com",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(y.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.auth().signOut();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=new Array(24).fill(0).map((function(e,t){return{hour:t,value:0}}));return e.forEach((function(e){var a=e.time,n=e.value,r=W(a);t[r]=Object(c.a)(Object(c.a)({},t[r]),{},{value:t[r].value+n})})),t},M=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"day",a=e.filter((function(e){var a=e.time;return f()(a).isSame(f()(),t)}));return a.reduce((function(e,t){return e+t.value}),0)},W=function(e){return+f()(e).format("H")},D={data:{plots:{voltage:{data:[]},activations:{data:[]}},currentState:{voltage:{value:0,lastPush:f()()},recentActivity:{day:0,week:0,month:0}},settings:{activeTime:0,sleepTime:0,sprayInterval:0}},startService:function(){},fetchData:function(){var e=Object(y.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fetchSettings:function(){var e=Object(y.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),saveSettings:function(){var e=Object(y.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),isFetching:!0},V=r.a.createContext(D),z=a(2),G=function(){var e,t=Object(n.useContext)(V).data.currentState.voltage,a=t.value,r=t.lastPush,s=(e=a)<m[0]?[d.a,"#eb3f33"]:e<m[1]?[d.d,"#ffce5c"]:e<m[2]?[d.c,"#5fd393"]:e<m[3]?[d.e,"#5fd393"]:[d.b,"#5fd393"];return Object(z.jsxs)("div",{className:v.a.battery,children:[Object(z.jsx)(u.a,{icon:s[0],color:s[1]}),Object(z.jsx)("div",{children:a+"V"}),Object(z.jsx)("div",{style:{color:"#888"},children:function(){var e=f()(),t="seconds",a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"s";return e.diff(f()(r),t)},n=a("s");return n>=60&&(t="minutes",(n=a("m"))>=60&&(t="hours",(n=a("h"))>=24&&(t="days",n=a("d")))),[n,t]}().join(" ")+" ago"})]})},P=function(){return Object(z.jsxs)("div",{className:l.a.bar,children:[Object(z.jsx)("div",{className:l.a.barTitle,children:"AirPshicker"}),Object(z.jsx)(G,{})]})},H=a(32),R=a.n(H),E=a(54),L=a(11),U=a.n(L),Y=a(30),J=a.n(Y),q=a(31),K=a.n(q),Z=function(e){var t=e.data,a=void 0===t?[]:t,n={colors:["#5fd393"],chart:{type:"area",stacked:!1,height:350,zoom:{type:"x",enabled:!0,autoScaleYaxis:!0},toolbar:{autoSelected:"zoom",tools:{download:!1,selection:!0,zoom:!0,zoomin:!1,zoomout:!1,pan:!0,reset:1,customIcons:[]}}},dataLabels:{enabled:!1},markers:{size:0},title:{text:"Battery Voltage",align:"left",style:{fontFamily:"Montserrat, sans-serif",fontWeight:700}},fill:{colors:["#5fd393"]},yaxis:{max:h,min:p,type:"numeric",title:{text:"Volts",style:{fontFamily:"Montserrat, sans-serif",fontWeight:500}},labels:{formatter:function(e){return e.toFixed(1)},style:{fontFamily:"Montserrat, sans-serif",fontWeight:500}}},xaxis:{type:"numeric",categories:a.map((function(e){return e.time})),labels:{formatter:function(e){return f()(e).format("DD.MM HH:mm")},style:{fontFamily:"Montserrat, sans-serif",fontWeight:500}}},tooltip:{shared:!1,style:{fontFamily:"Montserrat, sans-serif",fontWeight:500}}},r=[{name:"Battery",data:a.map((function(e,t){var a=e.value;e.time;return a}))}];return Object(z.jsx)("div",{className:K.a.graphContainer,children:Object(z.jsx)(J.a,{options:n,series:r,type:"area",height:350,style:{width:"100%"}})})},Q=function(e){var t=e.data,a=void 0===t?[]:t,n=[{data:a.map((function(e){return e.value})),name:"Activations"}],r={chart:{width:380,type:"radar",toolbar:{tools:{download:!1}}},title:{text:"Daily usage",align:"left",style:{fontFamily:"Montserrat, sans-serif",fontWeight:700}},plotOptions:{radar:{polygons:{strokeColor:"transparent",fill:{colors:["#fff"]}}}},labels:a.map((function(e){return e.hour})),fill:{opacity:.4},stroke:{show:!1,width:2,colors:[],dashArray:0},markers:{size:3},yaxis:{show:!1,labels:{formatter:function(e){return e+" times"}}},xaxis:{show:!0,categories:a.map((function(e){return e.hour+":00"})),labels:{show:!0,style:{fontFamily:"Montserrat, sans-serif",fontWeight:500}}},legend:{show:!1},tooltip:{style:{fontFamily:"Montserrat, sans-serif",fontWeight:500}}};return Object(z.jsx)("div",{className:K.a.graphContainer,children:Object(z.jsx)(J.a,{type:"radar",options:r,series:n,height:350,style:{width:"100%"}})})},X=a(24),$=a.n(X),ee=a(13),te=a.n(ee),ae=a(23),ne=function(e){var t=e.isVisible,a=e.onClose,r=void 0===a?function(){}:a,s=(e.user,e.isSignedIn),i=void 0!==s&&s,o=Object(n.useContext)(V),l=o.data.settings,j=o.fetchSettings,f=o.saveSettings,b=Object(n.useState)(l),v=Object(O.a)(b,2),p=v[0],h=v[1],m=Object(n.useState)(""),x=Object(O.a)(m,2),_=x[0],w=x[1],k=function(){var e=Object(y.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(_);case 2:w("");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(y.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(p);case 2:r();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){j(),h(l)}),[t]),i?Object(z.jsxs)("div",{className:$()(te.a.wrapper,t&&te.a.show),children:[Object(z.jsxs)("div",{className:te.a.settingsHeader,children:[Object(z.jsx)("h1",{children:"Settings"}),Object(z.jsx)("div",{className:te.a.signOut,onClick:I,children:Object(z.jsx)(u.a,{icon:d.g,color:"#888"})})]}),Object(z.jsxs)("div",{className:te.a.section,children:[Object(z.jsx)("span",{children:"Waiting time before sleep"}),Object(z.jsxs)("div",{className:te.a.inputArea,children:[Object(z.jsx)("input",{value:p.activeTime,onChange:function(e){return h((function(t){return Object(c.a)(Object(c.a)({},t),{},{activeTime:e.target.value})}))},type:"number"}),"seconds"]})]}),Object(z.jsxs)("div",{className:te.a.section,children:[Object(z.jsx)("span",{children:"Sleep time"}),Object(z.jsxs)("div",{className:te.a.inputArea,children:[Object(z.jsx)("input",{value:p.sleepTime,onChange:function(e){return h((function(t){return Object(c.a)(Object(c.a)({},t),{},{sleepTime:e.target.value})}))},type:"number"}),"seconds"]})]}),Object(z.jsxs)("div",{className:te.a.section,children:[Object(z.jsx)("span",{children:"Spray interval"}),Object(z.jsxs)("div",{className:te.a.inputArea,children:[Object(z.jsx)("input",{type:"number",disabled:!0}),"minutes"]})]}),Object(z.jsx)("button",{onClick:N,children:"Apply changes"}),Object(z.jsx)("div",{onClick:r,className:te.a.goBack,children:"< Back to home screen"})]}):Object(z.jsxs)("div",{className:$()(te.a.wrapper,t&&te.a.show),children:[Object(z.jsx)("h1",{children:"What's the password?"}),Object(z.jsxs)("div",{className:te.a.section,children:[Object(z.jsx)("span",{children:"You need to sign in to modify settings"}),Object(z.jsx)("div",{className:te.a.inputArea,children:Object(z.jsx)("input",{value:_,type:"password",style:{flex:1},placeholder:"Password",onChange:function(e){return w(e.target.value)}})}),Object(z.jsx)("button",{onClick:k,children:"Sign in"}),Object(z.jsx)("div",{onClick:r,className:te.a.goBack,children:"< Back to home screen"})]})]})},re=function(e){var t=e.gridArea,a=void 0===t?"":t,n=e.mainComponent,r=void 0===n?"":n,s=e.bottomText,i=void 0===s?"":s,c=e.onCLick;return Object(z.jsxs)("div",{className:$()(U.a.card,c&&U.a.clickable),onClick:function(){c&&c()},style:{gridArea:a},children:[Object(z.jsx)("div",{className:U.a.cardMainContent,children:r}),Object(z.jsx)("div",{className:U.a.cardBottomText,children:i})]})},se=function(e){var t=e.gridArea,a=void 0===t?"":t,n=Object(E.a)(e,["gridArea"]);return Object(z.jsx)("div",{className:U.a.card,style:{gridArea:a},children:n.children})},ie=function(){var e,t,a,r,s,i,c=Object(n.useState)(!1),o=Object(O.a)(c,2),l=o[0],j=o[1],f=Object(n.useContext)(V),b=f.data,v=f.startService;Object(n.useEffect)((function(){v()}),[]);var p=Object(z.jsxs)("div",{className:U.a.totalGrid,children:[Object(z.jsxs)("div",{className:U.a.totalRow,children:[Object(z.jsx)("div",{className:U.a.totalTitle,children:"Today"}),Object(z.jsx)("div",{className:U.a.totalValue,children:null===(e=b.currentState)||void 0===e||null===(t=e.recentActivity)||void 0===t?void 0:t.day})]}),Object(z.jsxs)("div",{className:U.a.totalRow,children:[Object(z.jsx)("div",{className:U.a.totalTitle,children:"Week"}),Object(z.jsx)("div",{className:U.a.totalValue,children:null===(a=b.currentState)||void 0===a||null===(r=a.recentActivity)||void 0===r?void 0:r.week})]}),Object(z.jsxs)("div",{className:U.a.totalRow,children:[Object(z.jsx)("div",{className:U.a.totalTitle,children:"Month"}),Object(z.jsx)("div",{className:U.a.totalValue,children:null===(s=b.currentState)||void 0===s||null===(i=s.recentActivity)||void 0===i?void 0:i.month})]})]});return Object(z.jsx)(ae.a,{children:function(e){var t,a,n,r,s,i,c,o,f,v=e.isSignedIn,h=e.user;e.providerId;return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(ne,{isSignedIn:v,user:h,isVisible:l,onClose:function(){return j(!1)}}),Object(z.jsxs)("div",{className:U.a.mainGrid,children:[Object(z.jsx)(re,{mainComponent:Object(z.jsxs)("div",{className:U.a.totalRow,children:[Object(z.jsx)("div",{className:U.a.totalTitle,children:"Volts"}),Object(z.jsx)("div",{className:U.a.totalValue,children:(null===(t=b.currentState)||void 0===t||null===(a=t.voltage)||void 0===a?void 0:a.value)||"0.0"})]}),bottomText:(f=null===(n=b.currentState)||void 0===n||null===(r=n.voltage)||void 0===r?void 0:r.value,f<m[0]?"Too low. Needs charging":f<m[1]?"Running low":f<m[2]?"Enough to work":f<m[3]?"Good":"Fully charged"),gridArea:"volt"}),Object(z.jsx)(re,{gridArea:"today",mainComponent:p,bottomText:"Activations"}),Object(z.jsx)(re,{gridArea:"sets",mainComponent:Object(z.jsx)(u.a,{icon:d.f}),bottomText:"Settings",onCLick:function(){return j((function(e){return!e}))}}),Object(z.jsx)(se,{gridArea:"graph1",children:Object(z.jsx)(Z,{data:null===(s=b.plots)||void 0===s||null===(i=s.voltage)||void 0===i?void 0:i.data})}),Object(z.jsx)(se,{gridArea:"graph2",children:Object(z.jsx)(Q,{data:null===(c=b.plots)||void 0===c||null===(o=c.activations)||void 0===o?void 0:o.data})})]})]})}})},ce={apiKey:"AIzaSyBLrODZWuYHlBeJIUwaNh6QDTkmhbxLcjE",authDomain:"air-freshener-iot.firebaseapp.com",databaseURL:"https://air-freshener-iot-default-rtdb.europe-west1.firebasedatabase.app",projectId:"air-freshener-iot",storageBucket:"air-freshener-iot.appspot.com",messagingSenderId:"369342205741",appId:"1:369342205741:web:d2ca55ee0fa251c5418da4"};var oe=function(){var e=function(){var e=Object(n.useState)(D),t=Object(O.a)(e,2),a=t[0],r=t[1];Object(n.useEffect)((function(){console.log(a)}),[a]);var s=function(){var e=Object(y.a)(g.a.mark((function e(){var t,a,n,s,i,o,l,u,d,j,f,b,v;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T();case 2:return t=e.sent,a=t.data,e.next=6,S();case 6:n=e.sent,s=n.data,i=Object.entries(a||{}).filter((function(e){return"last_id"!==Object(O.a)(e,1)[0]})).map((function(e){var t=Object(O.a)(e,2),a=(t[0],t[1]);return Object(c.a)(Object(c.a)({},a),{},{value:(a.value/1e3).toFixed(1),time:null===a||void 0===a?void 0:a.timestamp})})),o=i.slice(-1)[0],l=o.value,u=o.time,d=Object.entries(s||{}).filter((function(e){return"last_id"!==Object(O.a)(e,1)[0]})).map((function(e){var t=Object(O.a)(e,2),a=(t[0],t[1]);return Object(c.a)(Object(c.a)({},a),{},{time:null===a||void 0===a?void 0:a.timestamp})})),j=B(d),f=M(d,"day"),b=M(d,"week"),v=M(d,"month"),r((function(e){return Object(c.a)(Object(c.a)({},e),{},{isFetching:!1,data:Object(c.a)(Object(c.a)({},e.data),{},{plots:{voltage:{data:i},activations:{data:j}},currentState:{voltage:{value:l,lastPush:u},recentActivity:{day:f,week:b,month:v}}})})}));case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=function(){var e=Object(y.a)(g.a.mark((function e(){var t,a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:t=e.sent,a=t.activeTime,n=t.sleepTime,r((function(e){return Object(c.a)(Object(c.a)({},e),{},{data:Object(c.a)(Object(c.a)({},e.data),{},{settings:{activeTime:a,sleepTime:n,sprayInterval:0}})})}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o=function(){var e=Object(y.a)(g.a.mark((function e(t){var a,n,r,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.activeTime,n=void 0===a?0:a,r=t.sleepTime,s=void 0===r?0:r,e.next=3,A({activeTime:Number(n),sleepTime:Number(s)});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(c.a)(Object(c.a)({},a),{},{startService:function(){setInterval((function(){s()}),5e3)},fetchData:s,fetchSettings:i,saveSettings:o})}();return Object(n.useEffect)((function(){k.a.apps.length?k.a.app():k.a.initializeApp({}),e.fetchData()}),[]),Object(z.jsx)(ae.b,Object(c.a)(Object(c.a)({firebase:k.a},ce),{},{children:Object(z.jsxs)(V.Provider,{value:e,children:[Object(z.jsx)("div",{className:R.a.loadingOverlay,style:{opacity:Number(e.isFetching)}}),Object(z.jsx)("div",{className:R.a.contentWrapper,children:Object(z.jsxs)("div",{className:R.a.body,children:[Object(z.jsx)(P,{}),Object(z.jsx)(ie,{})]})})]})}))},le=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,131)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,i=t.getTTFB;a(e),n(e),r(e),s(e),i(e)}))};i.a.render(Object(z.jsx)(r.a.StrictMode,{children:Object(z.jsx)(oe,{})}),document.getElementById("root")),le()},31:function(e,t,a){e.exports={graphContainer:"styles_graphContainer__rvnP9"}},32:function(e,t,a){e.exports={loadingOverlay:"styles_loadingOverlay__25Hxt",body:"styles_body__32Flv",contentWrapper:"styles_contentWrapper__fzvAO"}},38:function(e,t,a){e.exports={bar:"style_bar__3UGFG",barTitle:"style_barTitle__2GbdM"}},51:function(e,t,a){e.exports={battery:"styles_battery__b2nck"}},59:function(e,t,a){}},[[130,1,2]]]);
//# sourceMappingURL=main.a4068422.chunk.js.map